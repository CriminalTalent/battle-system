<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PYXIS 관리자 페이지</title>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg:#0a0f1a; --panel:#141a24; --ink:#f8f6f0;
      --gold:#d4b77e; --gold-dark:#c9a96e; --gold-light:#dcc7a2;
      --border:#2a313a; --radius:10px;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{background:var(--bg);color:var(--ink);font-family:'Inter',sans-serif;line-height:1.5;padding:16px}
    h1,h2{font-family:'Cinzel',serif}
    .container{max-width:1200px;margin:0 auto;display:grid;grid-template-columns:1fr 1fr;gap:16px}
    .card{background:var(--panel);padding:16px;border:1px solid var(--border);border-radius:var(--radius)}
    .card-title{margin-bottom:12px;font-size:18px;color:var(--gold)}
    .form-group{margin-bottom:12px}
    .form-label{font-size:13px;color:#aaa;margin-bottom:4px;display:block}
    .form-input,.form-select,.stat-input{width:100%;padding:8px;border:1px solid var(--border);border-radius:6px;background:#1e252f;color:var(--ink)}
    .btn{padding:8px 12px;border:none;border-radius:6px;cursor:pointer;font-weight:600}
    .btn-primary{background:var(--gold);color:#000}
    .btn-primary:hover{background:var(--gold-light)}
    .player-item{display:flex;align-items:center;gap:8px;padding:6px;border-bottom:1px solid var(--border)}
    .player-avatar{width:40px;height:40px;border-radius:6px;object-fit:cover;border:2px solid var(--gold)}
    .player-name{font-weight:600}
    .player-status{font-size:12px;padding:2px 6px;border-radius:4px}
    .status-alive{background:rgba(39,174,96,.2);color:#27ae60}
    .status-dead{background:rgba(231,76,60,.2);color:#e74c3c}
    #battleLog{height:200px;overflow-y:auto;background:#1e252f;padding:8px;border-radius:6px;font-size:13px}
    .log-entry{margin-bottom:4px}
    .log-system{color:var(--gold-light)}
    .empty-state{color:#666;font-size:13px;padding:8px}
  </style>
</head>
<body>
  <h1 style="text-align:center;color:var(--gold);margin-bottom:20px">PYXIS 관리자</h1>
  <div class="container">
    <!-- 플레이어 추가 -->
    <div class="card">
      <h2 class="card-title">플레이어 추가</h2>
      <div class="form-group">
        <input type="text" id="playerName" class="form-input" placeholder="플레이어 이름" maxlength="20">
      </div>
      <div class="form-group">
        <select id="playerTeam" class="form-select">
          <option value="A">불사조 기사단</option>
          <option value="B">죽음을 먹는 자들</option>
        </select>
      </div>
      <div class="form-group">
        <label class="form-label">아바타 URL</label>
        <div style="display:flex;gap:8px;align-items:center">
          <input type="url" id="avatarUrl" class="form-input" placeholder="https://...">
          <img id="avatarPreview" style="width:60px;height:60px;border-radius:6px;object-fit:cover;border:1px solid var(--border)">
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">스탯 (각 0~5)</label>
        <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:6px">
          <input type="number" id="attackStat" class="stat-input" value="0" min="0" max="5" placeholder="ATK">
          <input type="number" id="defenseStat" class="stat-input" value="0" min="0" max="5" placeholder="DEF">
          <input type="number" id="agilityStat" class="stat-input" value="0" min="0" max="5" placeholder="AGI">
          <input type="number" id="luckStat" class="stat-input" value="0" min="0" max="5" placeholder="LUCK">
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">아이템</label>
        <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:6px">
          <input type="number" id="detinyCount" class="stat-input" value="0" min="0" max="9" placeholder="디터니">
          <input type="number" id="attackBoostCount" class="stat-input" value="0" min="0" max="9" placeholder="공격보정">
          <input type="number" id="defenseBoostCount" class="stat-input" value="0" min="0" max="9" placeholder="방어보정">
        </div>
      </div>
      <button class="btn btn-primary" id="addPlayerBtn">추가</button>
    </div>

    <!-- 팀 구성 -->
    <div class="card">
      <h2 class="card-title">팀 구성</h2>
      <h3 style="color:var(--gold-light)">불사조 기사단 (<span id="teamACount">0명</span>)</h3>
      <div id="teamAList" class="player-list"></div>
      <h3 style="margin-top:12px;color:var(--gold-light)">죽음을 먹는 자들 (<span id="teamBCount">0명</span>)</h3>
      <div id="teamBList" class="player-list"></div>
    </div>

    <!-- 로그 -->
    <div class="card" style="grid-column:1/3">
      <h2 class="card-title">로그</h2>
      <div id="battleLog"></div>
    </div>
  </div>

  <script>
    const $ = s => document.querySelector(s);
    const teamAList=$('#teamAList'),teamBList=$('#teamBList');
    const teamACount=$('#teamACount'),teamBCount=$('#teamBCount');
    const avatarUrl=$('#avatarUrl'),avatarPreview=$('#avatarPreview');
    const battleState={players:[]};

    function updateAvatarPreview(){
      const url=avatarUrl.value.trim();
      avatarPreview.src=url||'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="60" height="60"><rect width="100%" height="100%" fill="%231e293b"/><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" fill="%23aaa" font-size="10">NO IMG</text></svg>';
    }
    avatarUrl.addEventListener('input',updateAvatarPreview);updateAvatarPreview();

    function renderTeams(){
      const a=battleState.players.filter(p=>p.team==='A');
      const b=battleState.players.filter(p=>p.team==='B');
      function fill(list,arr){
        list.innerHTML='';
        if(!arr.length){list.innerHTML='<div class="empty-state">팀원을 추가해주세요</div>';return;}
        arr.forEach(p=>{
          list.innerHTML+=`
            <div class="player-item">
              <img src="${p.avatar||'https://api.dicebear.com/7.x/avataaars/svg?seed='+encodeURIComponent(p.name)}" class="player-avatar">
              <div class="player-name">${p.name}</div>
              <div class="player-status ${p.status==='alive'?'status-alive':'status-dead'}">${p.status==='alive'?'생존':'사망'}</div>
            </div>`;
        });
      }
      fill(teamAList,a);fill(teamBList,b);
      teamACount.textContent=a.length+'명';teamBCount.textContent=b.length+'명';
    }

    $('#addPlayerBtn').addEventListener('click',()=>{
      const name=$('#playerName').value.trim();if(!name){alert('이름을 입력하세요');return;}
      const team=$('#playerTeam').value;
      const stats={attack:+$('#attackStat').value||0,defense:+$('#defenseStat').value||0,agility:+$('#agilityStat').value||0,luck:+$('#luckStat').value||0};
      const statsForServer={attack:Math.max(1,stats.attack),defense:Math.max(1,stats.defense),agility:Math.max(1,stats.agility),luck:Math.max(1,stats.luck)};
      const items={dittany:+$('#detinyCount').value||0,attackBoost:+$('#attackBoostCount').value||0,defenseBoost:+$('#defenseBoostCount').value||0};
      const player={id:'P'+Math.random().toString(36).slice(2,8),name,team,avatar:avatarUrl.value.trim()||null,stats:statsForServer,hp:100,maxHp:100,items,status:'alive'};
      battleState.players.push(player);
      renderTeams();
      const log=document.getElementById('battleLog');
      const ts=new Date().toLocaleTimeString('ko-KR',{hour:'2-digit',minute:'2-digit'});
      log.innerHTML+=`<div class="log-entry log-system"><span class="log-timestamp">${ts}</span> ${name} 이(가) ${team==='A'?'불사조 기사단':'죽음을 먹는 자들'}에 추가되었습니다.</div>`;
      log.scrollTop=log.scrollHeight;
      $('#playerName').value='';
    });

    renderTeams();
  </script>
</body>
</html>
