<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="x-ua-compatible" content="ie=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PYXIS Admin</title>
  <style>
    :root{
      --bg:#0b1119;
      --panel:#111926;
      --muted:#a9b3c1;
      --text:#e7ebf1;
      --gold:#dcc7a2;
      --gold-soft:#cdb894;
      --line:rgba(220,199,162,.25);
      --danger:#c73e1d;
      --ok:#2d5a27;
      --accent:#3c6eeb;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:linear-gradient(180deg,#0b1119,#0d1421 60%,#0b1119);
      color:var(--text); font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple SD Gothic Neo","Noto Sans KR","Malgun Gothic",sans-serif;
    }
    .wrap{max-width:1200px; margin:0 auto; padding:20px; display:flex; flex-direction:column; gap:14px}
    header.top{
      display:flex; align-items:center; justify-content:space-between;
      padding:12px 16px; background:var(--panel); border:1px solid var(--line); border-radius:12px;
    }
    .brand{font-weight:800; letter-spacing:.5px; color:var(--gold)}
    .statusline{display:flex; gap:14px; align-items:center; color:var(--muted); font-size:14px}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace}
    .conn{display:inline-flex; align-items:center; gap:8px}
    .dot{width:10px;height:10px;border-radius:50%;background:#666;display:inline-block;border:1px solid #0003}
    .dot.ok{background:var(--ok)}
    .dot.bad{background:#666}
    .grid{
      display:grid; grid-template-columns: 1.1fr .9fr; gap:14px;
    }
    .panel{
      background:var(--panel); border:1px solid var(--line); border-radius:12px; padding:14px;
    }
    h2{margin:0 0 10px 0; font-size:18px; color:var(--gold)}
    h3{margin:0 0 10px 0; font-size:16px; color:var(--gold-soft)}
    .row{display:flex; flex-wrap:wrap; gap:10px; align-items:center}
    .row + .row{margin-top:10px}
    label{font-size:13px; color:var(--muted)}
    input[type="text"],input[type="number"],select{
      background:#0f1725; color:var(--text); border:1px solid #203049; border-radius:8px; padding:8px 10px; min-width:0;
    }
    input[type="file"]{color:var(--muted)}
    .btn{
      background:#1a2740; color:#e9eef7; border:1px solid #223454; border-radius:10px; padding:8px 12px; cursor:pointer; font-weight:600;
    }
    .btn:hover{filter:brightness(1.06)}
    .btn.primary{background:var(--accent); border-color:#2b55d8}
    .btn.gold{background:#3b3322; color:var(--gold); border-color:var(--gold-soft)}
    .btn.danger{background:#3a1f1a; color:#f6d2c9; border-color:#803328}
    .btn.ghost{background:#121a29}
    .btn + .btn{margin-left:6px}
    .stack{display:flex; flex-direction:column; gap:10px}
    .two{display:grid; grid-template-columns:1fr 1fr; gap:10px}
    .three{display:grid; grid-template-columns:repeat(3,1fr); gap:10px}
    .four{display:grid; grid-template-columns:repeat(4,1fr); gap:10px}
    .six{display:grid; grid-template-columns:repeat(6,1fr); gap:10px}
    .scroll{max-height:280px; overflow:auto; padding-right:6px}
    .muted{color:var(--muted)}
    .sep{height:1px; background:var(--line); margin:10px 0}
    .copy-board{display:flex; flex-direction:column; gap:8px}
    .copy-row{display:flex; justify-content:space-between; gap:10px; border:1px dashed var(--line); border-radius:8px; padding:8px 10px; background:#0f1725}
    .copy-label{color:var(--gold-soft); font-weight:600}
    .copy-value{color:#c9d6ff; cursor:pointer; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; max-width:100%}
    /* roster */
    .rosters{display:grid; grid-template-columns:1fr 1fr; gap:10px}
    .roster-col h3{margin-bottom:6px}
    .player{
      border:1px solid var(--line); border-radius:10px; padding:10px; background:#0f1725; display:flex; flex-direction:column; gap:8px
    }
    .player .top{display:flex; align-items:flex-start; justify-content:space-between; gap:10px}
    details{border-top:1px dashed var(--line); padding-top:6px}
    summary{cursor:pointer; color:var(--muted)}
    /* chat & log */
    #chatView,#battleLog{background:#0f1725; border:1px solid var(--line); border-radius:8px; padding:8px; font-size:13px}
    .chat-input{display:flex; gap:8px; margin-top:6px}
    .footer-note{font-size:12px; color:var(--muted)}
    @media (max-width: 1024px){
      .grid{grid-template-columns:1fr}
      .rosters{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header class="top">
      <div class="brand">PYXIS Battle Admin</div>
      <div class="statusline">
        <span>전투 ID: <span id="currentBattleId" class="mono">-</span></span>
        <span>모드: <span id="currentMode" class="mono">-</span></span>
        <span class="conn">
          <span id="connDot" class="dot bad"></span>
          <span id="connText">해제됨</span>
        </span>
      </div>
    </header>

    <div class="grid">
      <!-- LEFT -->
      <section class="panel stack">
        <h2>전투 제어</h2>

        <div class="panel">
          <h3>전투 생성</h3>
          <div class="row">
            <label for="battleMode">모드</label>
            <select id="battleMode">
              <option value="1v1">1v1</option>
              <option value="2v2">2v2</option>
              <option value="3v3">3v3</option>
              <option value="4v4">4v4</option>
            </select>
            <button id="btnCreateBattle" class="btn primary">전투 생성</button>
          </div>
          <div class="sep"></div>
          <div class="row">
            <button id="btnStartBattle" class="btn gold">시작</button>
            <button id="btnPauseBattle" class="btn ghost">일시정지</button>
            <button id="btnResumeBattle" class="btn ghost">재개</button>
            <button id="btnEndBattle" class="btn danger">종료</button>
          </div>
        </div>

        <div class="panel">
          <h3>전투 참가자 추가</h3>
          <div class="two">
            <div class="stack">
              <label>이름</label>
              <input id="pName" type="text" placeholder="이름" />
            </div>
            <div class="stack">
              <label>팀</label>
              <select id="pTeam">
                <option value="phoenix">불사조 기사단</option>
                <option value="eaters">죽음을 먹는자</option>
              </select>
            </div>
          </div>

          <div class="two">
            <div class="stack">
              <label>HP</label>
              <input id="pHP" type="number" min="1" value="100" />
            </div>
            <div class="stack">
              <label>아바타</label>
              <input id="pImage" type="file" accept="image/*" />
            </div>
          </div>

          <div class="four">
            <div class="stack">
              <label>공격</label>
              <input id="sATK" type="number" min="1" max="10" value="3" />
            </div>
            <div class="stack">
              <label>방어</label>
              <input id="sDEF" type="number" min="1" max="10" value="3" />
            </div>
            <div class="stack">
              <label>민첩</label>
              <input id="sDEX" type="number" min="1" max="10" value="3" />
            </div>
            <div class="stack">
              <label>행운</label>
              <input id="sLUK" type="number" min="1" max="10" value="3" />
            </div>
          </div>

          <div class="three">
            <div class="stack">
              <label>디터니</label>
              <input id="itemDittany" type="number" min="0" value="1" />
            </div>
            <div class="stack">
              <label>공격 보정기</label>
              <input id="itemAtkBoost" type="number" min="0" value="1" />
            </div>
            <div class="stack">
              <label>방어 보정기</label>
              <input id="itemDefBoost" type="number" min="0" value="1" />
            </div>
          </div>

          <div class="row" style="margin-top:8px">
            <button id="btnAddPlayer" class="btn primary">전투 참가자 추가</button>
          </div>
        </div>

        <div class="panel">
          <h3>링크 발급</h3>
          <div class="row">
            <button id="btnIssuePlayerLinks" class="btn gold">플레이어 링크 발급</button>
            <button id="btnIssueSpectatorLink" class="btn ghost">관전자 링크 발급</button>
          </div>
          <div class="sep"></div>
          <div class="copy-board" id="issueList">
            <!-- admin.js가 채움 -->
          </div>
          <div class="footer-note">주소를 클릭하면 클립보드로 복사됩니다.</div>
        </div>

        <div class="panel">
          <h3>인원 목록</h3>
          <div class="rosters">
            <div class="roster-col">
              <h3>불사조 기사단</h3>
              <div id="rosterPhoenix" class="stack"></div>
            </div>
            <div class="roster-col">
              <h3>죽음을 먹는자</h3>
              <div id="rosterEaters" class="stack"></div>
            </div>
          </div>
        </div>
      </section>

      <!-- RIGHT -->
      <aside class="panel stack">
        <h2>대시보드</h2>

        <div class="panel">
          <h3>채팅</h3>
          <div id="chatView" class="scroll"></div>
          <div class="chat-input">
            <input id="chatText" type="text" placeholder="메시지 입력" />
            <button id="btnChatSend" class="btn">전송</button>
          </div>
        </div>

        <div class="panel">
          <h3>타임라인</h3>
          <div id="battleLog" class="scroll"></div>
        </div>
      </aside>
    </div>
  </div>

  <!-- Socket.IO 클라이언트 -->
  <script src="/socket.io/socket.io.js"></script>
  <!-- 관리자 스크립트 -->
  <script defer src="/assets/js/admin.js"></script>
  <script>
    // 팀 한글 표기를 JS에서 사용하는 경우도 맞춰주고 싶다면:
    window.__TEAM_LABEL__ = {
      phoenix: '불사조 기사단',
      eaters:  '죽음을 먹는자'   // 공백 없이
    };
  </script>
</body>
</html>
