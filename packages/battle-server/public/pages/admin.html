<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PYXIS Admin</title>
  <style>
    :root {
      --bg: #0b0e13;
      --panel: #121722;
      --muted: #72809b;
      --text: #e8eefc;
      --brand: #5b8cff;
      --ok: #25c59b;
      --warn: #ffb020;
      --err: #ff5861;
      --border: #222a39;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0; background: radial-gradient(1200px 800px at 80% -10%, #182034 0%, #0b0e13 60%) fixed, var(--bg);
      color: var(--text); font: 14px/1.5 system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", sans-serif;
    }
    .wrap { max-width: 980px; margin: 32px auto; padding: 0 16px; }
    h1 { font-size: 20px; margin: 0 0 16px; letter-spacing: 0.2px; }
    .panel {
      background: rgba(18, 23, 34, 0.7); border: 1px solid var(--border);
      border-radius: 14px; padding: 18px; backdrop-filter: blur(6px);
      box-shadow: 0 8px 24px rgba(0,0,0,0.25);
      margin-bottom: 18px;
    }
    .row { display: grid; grid-template-columns: 160px 1fr auto; gap: 10px; align-items: center; padding: 8px 0; }
    .row > label { color: var(--muted); }
    .input, .output {
      width: 100%; padding: 10px 12px; border-radius: 10px; border: 1px solid var(--border);
      background: #0e141f; color: var(--text); outline: none;
    }
    .output[readonly] { opacity: 0.95; }
    .btn {
      padding: 10px 14px; border-radius: 10px; border: 1px solid var(--border);
      background: linear-gradient(180deg, #1a2333, #121a29); color: var(--text);
      cursor: pointer; user-select: none; transition: 120ms ease;
    }
    .btn:hover { transform: translateY(-1px); box-shadow: 0 6px 16px rgba(0,0,0,0.25); }
    .btn.brand { background: linear-gradient(180deg, #5b8cff, #3f6fea); border-color: #3a64d9; color: #fff; }
    .btn.ghost { background: transparent; }
    .grid2 { display: grid; grid-template-columns: 1fr auto; gap: 10px; align-items: stretch; }
    .grid4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; }
    .help { color: var(--muted); font-size: 12px; margin-top: 6px; }
    .divider { height: 1px; background: var(--border); margin: 10px 0; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; }
    .badges { display: flex; gap: 8px; flex-wrap: wrap; }
    .badge {
      padding: 4px 8px; border: 1px solid var(--border); border-radius: 999px; color: var(--muted);
      background: #0f1522;
    }
    .toast {
      position: fixed; right: 16px; bottom: 16px; padding: 12px 14px; border-radius: 12px;
      border: 1px solid var(--border); background: #101626; color: var(--text);
      box-shadow: 0 8px 24px rgba(0,0,0,0.35); z-index: 9999; opacity: 0; transform: translateY(8px);
      transition: 160ms ease;
    }
    .toast.show { opacity: 1; transform: translateY(0); }
    .toast.ok { border-color: #16483e; background: rgba(37,197,155,0.1); }
    .toast.warn { border-color: #5b4214; background: rgba(255,176,32,0.08); }
    .toast.err { border-color: #612228; background: rgba(255,88,97,0.08); }
    @media (max-width: 700px) {
      .row { grid-template-columns: 1fr; }
      .grid4 { grid-template-columns: 1fr; }
      .grid2 { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>🛰️ PYXIS Battle Admin</h1>

    <div class="panel">
      <div class="row">
        <label>Battle ID</label>
        <input id="battleId" class="input mono" placeholder="예: 276BCN34" />
        <button id="setBattleId" class="btn">적용</button>
      </div>
      <div class="row">
        <label>빠른 생성</label>
        <div class="badges">
          <span class="badge">모드: 1v1</span>
          <span class="badge">링크/OTP는 아래에서 발급</span>
        </div>
        <button id="createBattle" class="btn brand">전투 생성</button>
      </div>
      <div class="help">URL 파라미터 <span class="mono">?battle=XXXX</span> 를 사용해도 자동 적용됩니다.</div>
    </div>

    <div class="panel">
      <div class="row">
        <label>공유 링크 발급</label>
        <div class="grid2">
          <div class="help">관리자/플레이어/관전자 접근 URL 일괄 생성</div>
          <button id="genLinks" class="btn">링크 생성</button>
        </div>
      </div>
      <div class="row">
        <label>Admin 링크</label>
        <input id="adminLink" class="output mono" readonly placeholder="생성 후 표시됩니다" />
        <button data-copy="#adminLink" class="btn ghost">복사</button>
      </div>
      <div class="row">
        <label>Player1 링크</label>
        <input id="p1Link" class="output mono" readonly placeholder="생성 후 표시됩니다" />
        <button data-copy="#p1Link" class="btn ghost">복사</button>
      </div>
      <div class="row">
        <label>Player2 링크</label>
        <input id="p2Link" class="output mono" readonly placeholder="생성 후 표시됩니다" />
        <button data-copy="#p2Link" class="btn ghost">복사</button>
      </div>
      <div class="row">
        <label>Spectator 링크</label>
        <input id="spectatorLink" class="output mono" readonly placeholder="생성 후 표시됩니다" />
        <button data-copy="#spectatorLink" class="btn ghost">복사</button>
      </div>
    </div>

    <div class="panel">
      <div class="row">
        <label>OTP 발급</label>
        <div class="grid4">
          <button id="genPlayerOtp" class="btn">Player OTP 발급</button>
          <input id="playerOtp" class="output mono" readonly placeholder="예: 6자리" />
          <button id="genSpectatorOtp" class="btn">Spectator OTP 발급</button>
          <input id="spectatorOtp" class="output mono" readonly placeholder="예: 6자리" />
        </div>
      </div>
      <div class="help">서버 설정(기본값): spectator 30회/30분, player 3회/2시간, admin 1회/24시간</div>
    </div>

    <div class="panel">
      <div class="row">
        <label>바로가기</label>
        <div class="grid4">
          <a class="btn ghost" href="/play" target="_blank" rel="noreferrer">Player 페이지</a>
          <a class="btn ghost" href="/spectator" target="_blank" rel="noreferrer">관전자 페이지</a>
          <a class="btn ghost" href="/admin" target="_blank" rel="noreferrer">Admin 페이지</a>
          <a class="btn ghost" href="/api/health" target="_blank" rel="noreferrer">API Health</a>
        </div>
      </div>
    </div>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script src="./admin.js"></script>
</body>
</html>
