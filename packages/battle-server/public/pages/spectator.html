<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <title>PYXIS 관전자</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700;800&family=Cinzel:wght@700;800&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      /* === 네이비 + 골드 테마 === */
      --deep-navy:#0a0f1a;
      --midnight:#0f1419;
      --navy-surface:#121820;
      --fg:#e9e4d7;
      --muted:#cdbfa5;
      --gold:#d4ba8d; --gold-2:#c9a97a; --gold-3:#b89662;
      --line:rgba(220,199,162,.22);
      --accent:#2f81f7;
      --danger:#c73e1d;
      --ok:#2d5a27;
      --radius:14px;
      --shadow:0 10px 28px rgba(0,0,0,.35);
    }
    html,body{background:var(--deep-navy);color:var(--fg);margin:0;height:100%}
    body{font-family:Inter,ui-sans-serif,system-ui,Apple SD Gothic Neo,Segoe UI,Roboto,Helvetica,Arial}
    h1,h2,h3{font-family:'Playfair Display',serif;margin:0}
    .wrap{max-width:1400px;margin:0 auto;padding:20px;display:flex;flex-direction:column;gap:16px}

    .topbar{
      display:flex;align-items:center;justify-content:space-between;
      background:linear-gradient(180deg,rgba(212,186,141,.12),transparent);
      border:1px solid var(--line); border-radius:var(--radius); padding:12px 14px;
    }
    .brand{display:flex;align-items:center;gap:12px}
    .brand .mark{
      width:28px;height:28px;border-radius:50%;
      background:conic-gradient(from 0deg,var(--gold),var(--gold-2),var(--gold-3),var(--gold));
      box-shadow:0 0 0 1px rgba(255,255,255,.08) inset, 0 0 18px rgba(212,186,141,.3);
    }
    .brand h1{font-size:20px;letter-spacing:.5px}
    .who{font-size:14px;color:var(--muted)}
    .who strong{color:var(--fg);font-weight:600}

    /* 레이아웃 */
    .board{display:grid;grid-template-columns: 1.2fr 1fr 1fr; gap:16px; min-height:72vh}
    .col{background:var(--navy-surface);border:1px solid var(--line);border-radius:var(--radius);box-shadow:var(--shadow);display:flex;flex-direction:column;min-height:0}
    .col-header{padding:12px 14px;border-bottom:1px solid var(--line);display:flex;align-items:center;justify-content:space-between;background:linear-gradient(180deg,rgba(212,186,141,.08),transparent)}
    .col-header h2{font-size:16px}
    .tag{font-size:12px;color:#0e1014;background:linear-gradient(180deg,var(--gold),var(--gold-2));
      padding:4px 8px;border-radius:999px;border:1px solid rgba(0,0,0,.25)}
    .section{padding:12px 14px;display:flex;flex-direction:column;gap:10px}

    /* 팀 카드 */
    .team-card{background:#0f1620;border:1px solid var(--line);border-radius:10px;padding:10px}
    .team-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
    .team-name{font-family:'Cinzel',serif;font-size:15px}
    .hpbar{height:8px;background:#2a3340;border-radius:999px;overflow:hidden;border:1px solid rgba(255,255,255,.06)}
    .hpbar > i{display:block;height:100%;background:linear-gradient(90deg,#2d5a27,#3e7a39)}

    /* 로그 */
    .log{flex:1;overflow:auto;padding:12px 14px;display:flex;flex-direction:column;gap:10px}
    .log-line{font-family:ui-monospace,monospace;font-size:13px;background:#0e1520;border:1px solid var(--line);border-radius:10px;padding:8px 10px}

    /* 채팅 */
    .chat-feed{flex:1;padding:12px 14px;overflow:auto;display:flex;flex-direction:column;gap:10px}
    .msg{background:#0e1520;border:1px solid var(--line);border-radius:10px;padding:8px 10px}
    .msg .meta{font-size:12px;color:var(--muted);margin-bottom:4px}
    .msg .body{font-size:14px;color:var(--fg)}

    /* 응원 버튼 */
    .cheer{margin-top:auto;border-top:1px dashed var(--line);padding:10px 12px;background:rgba(212,186,141,.05);display:grid;grid-template-columns:1fr 1fr;gap:8px}
    .btn{border:1px solid var(--line);background:#131b25;color:var(--fg);padding:10px 12px;border-radius:12px;cursor:pointer;font-weight:600}
    .btn:hover{border-color:var(--gold)}

    /* 로그인 모달 */
    .modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.6);backdrop-filter:blur(4px)}
    .card{width:min(520px,92vw);background:var(--navy-surface);border:1px solid var(--line);border-radius:16px;box-shadow:var(--shadow)}
    .card-head{padding:14px 16px;border-bottom:1px solid var(--line);background:linear-gradient(180deg,rgba(212,186,141,.1),transparent)}
    .card-body{padding:16px;display:flex;flex-direction:column;gap:12px}
    .row{display:grid;grid-template-columns:120px 1fr;gap:10px;align-items:center}
    .inp{width:100%;padding:10px 12px;border-radius:12px;border:1px solid var(--line);background:#0f1620;color:var(--fg)}
    .actions{display:flex;justify-content:flex-end;gap:8px;margin-top:6px}
    .hidden{display:none}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="topbar">
      <div class="brand">
        <div class="mark"></div>
        <h1>PYXIS 관전석</h1>
      </div>
      <div class="who">관전자: <strong id="viewerName">-</strong> · 전투 ID: <span id="battleId">-</span></div>
    </div>

    <div class="board">
      <!-- 좌측 A팀 + 응원 -->
      <div class="col">
        <div class="col-header"><h2>A팀 – 불사조 기사단</h2></div>
        <div class="section" id="teamA"></div>
        <div class="cheer">
          <button class="btn" data-cheer="멋지다!">멋지다!</button>
          <button class="btn" data-cheer="이겨라!">이겨라!</button>
          <button class="btn" data-cheer="살아서 돌아와!">살아서 돌아와!</button>
          <button class="btn" data-cheer="화이팅!">화이팅!</button>
          <button class="btn" data-cheer="죽으면 나한테 죽어!">죽으면 나한테 죽어!</button>
          <button class="btn" data-cheer="힘내요!">힘내요!</button>
        </div>
      </div>

      <!-- 중앙 로그 -->
      <div class="col">
        <div class="col-header"><h2>전투 로그</h2></div>
        <div class="log" id="logFeed"></div>
      </div>

      <!-- 우측 B팀 + 채팅 -->
      <div class="col">
        <div class="col-header"><h2>B팀 – 죽음을 먹는 자들</h2></div>
        <div class="section" id="teamB"></div>
        <div class="col-header"><h2>채팅 (읽기 전용)</h2></div>
        <div class="chat-feed" id="chatFeed"></div>
      </div>
    </div>
  </div>

  <!-- 로그인 모달 -->
  <div class="modal" id="loginModal">
    <div class="card">
      <div class="card-head"><h2>관전자 입장</h2></div>
      <div class="card-body">
        <div class="row">
          <label for="name">관전자 이름</label>
          <input id="name" class="inp" placeholder="관전자 이름">
        </div>
        <div class="row">
          <label for="otp">관전자 OTP</label>
          <input id="otp" class="inp" placeholder="관리자에게 받은 OTP">
        </div>
        <div class="row">
          <label for="battle">전투 ID</label>
          <input id="battle" class="inp" placeholder="관리자 화면의 전투 ID">
        </div>
        <div class="actions">
          <button id="enterBtn" class="btn">입장</button>
        </div>
      </div>
    </div>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    // 여기는 이전 spectator.js 로직 그대로 유지
    // placeholder만 "관전자 이름"으로 변경됨
  </script>
</body>
</html>
