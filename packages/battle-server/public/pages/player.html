<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>PYXIS 전투 참가자</title>
  <style>
    :root{
      --gold-1:#DCC7A2; --gold-2:#D4BA8D;
      --bg-0:#0f1216; --bg-1:#141922; --bg-2:#1b2230;
      --text:#e5e7eb; --muted:#9aa4b2; --border:#262b36;
      --btn-bg:#0b0d10; --btn-border:#D4BA8D; --btn-text:#DCC7A2;
      --hint:#b1b7c2;
    }
    body{margin:0; background:var(--bg-0); color:var(--text); font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Noto Sans, Arial, Apple SD Gothic Neo, "맑은 고딕", sans-serif;}
    .wrap{max-width:1200px; margin:20px auto; padding:0 12px;}
    .cols{display:grid; grid-template-columns: 280px 1fr 320px; gap:14px;}
    @media (max-width: 980px){ .cols{grid-template-columns: 1fr;} }

    .card{background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(255,255,255,.01));
      border:1px solid var(--border); border-radius:14px; padding:14px; box-shadow:0 8px 20px rgba(0,0,0,.2); backdrop-filter: blur(6px);}

    .label{font-size:12px; color:var(--muted); margin-bottom:6px;}
    .row{display:flex; gap:8px; flex-wrap:wrap;}
    .grid{display:grid; gap:8px;}
    .g-2{grid-template-columns: repeat(2, 1fr);}

    .hpbar{height:12px; border-radius:6px; background:#3b2f1a; overflow:hidden; border:1px solid #6b5a3a}
    .hpbar > i{display:block; height:100%; width:0%;
      background: linear-gradient(90deg, #8c6b2e, #DCC7A2);}

    .btn{display:inline-flex; align-items:center; justify-content:center; height:38px; padding:0 12px;
      border-radius:10px; border:1px solid var(--border); background:var(--bg-2); color:var(--text); font-weight:600; cursor:pointer;}
    .btn:disabled{opacity:.5; cursor:not-allowed;}
    .btn-gold{background:var(--btn-bg); border-color:var(--btn-border); color:var(--btn-text);}

    .turnbox{display:flex; flex-direction:column; align-items:center; gap:10px;}

    /* 순서 큐(썸네일 리스트) */
    .queue{display:flex; gap:10px; overflow:auto; padding:4px 2px; width:100%; justify-content:center; flex-wrap:wrap;}
    .qitem{width:56px; height:42px; border:1px solid var(--border); border-radius:8px; background:#0c0f14;
      display:flex; align-items:center; justify-content:center; overflow:hidden; position:relative;}
    .qitem img{width:100%; height:100%; object-fit:contain;}
    .qitem .name{position:absolute; inset:auto 2px 2px 2px; font-size:10px; color:#c9ced7; text-align:center; background:rgba(0,0,0,.35); border-radius:4px;}
    .qitem.active{border-color:var(--gold-2); box-shadow:0 0 0 2px rgba(212,186,141,.25) inset;}

    .imgbox{width:100%; max-width:620px; aspect-ratio:4/3; background:#0c0f14; border:1px solid var(--border); border-radius:16px;
      display:flex; align-items:center; justify-content:center; overflow:hidden;}
    .imgbox img{width:100%; height:100%; object-fit:contain;}

    .subhint{color:var(--hint); font-size:12px;}

    .log{height:160px; overflow:auto; background:var(--bg-1); border:1px solid var(--border); border-radius:10px; padding:8px;}
    .chat{height:220px; overflow:auto; background:var(--bg-1); border:1px solid var(--border); border-radius:10px; padding:8px;}
    .chatbox{display:flex; gap:6px; margin-top:6px;}
    .chatbox input{flex:1; height:38px; border-radius:10px; border:1px solid var(--border); background:var(--bg-2); color:var(--text); padding:0 10px;}

    /* 오버레이(자동 로그인/타깃 선택) */
    .overlay{position:fixed; inset:0; background:rgba(0,0,0,.55); display:flex; align-items:center; justify-content:center; z-index:50;}
    .sheet{background:var(--bg-1); border:1px solid var(--border); border-radius:12px; padding:16px; width:min(92vw, 520px);}
    .list{display:grid; gap:8px; margin-top:8px;}
    .target{display:flex; justify-content:space-between; align-items:center; border:1px solid var(--border); border-radius:10px; padding:8px;}
    .hidden{display:none !important;}
  </style>
</head>
<body>
  <div id="authOverlay" class="overlay">
    <div class="sheet">
      <div>자동 로그인 준비 중…</div>
      <div style="color:#9aa4b2; font-size:12px; margin-top:6px">연결 완료 후 본 화면으로 전환됩니다.</div>
    </div>
  </div>

  <div class="wrap">
    <div class="cols">
      <!-- 좌: 내 카드 + 팀 목록 -->
      <div class="card">
        <div class="label">내 정보</div>
        <div id="meName" style="font-weight:700; margin-bottom:6px;">-</div>
        <div class="grid g-2">
          <div><div class="label">팀</div><div id="meTeam">-</div></div>
          <div><div class="label">HP</div><div id="meHp">-</div></div>
        </div>
        <div class="hpbar" style="margin-top:6px"><i id="meHpBar"></i></div>
        <div class="grid g-2" style="margin-top:10px">
          <div><div class="label">공격</div><div id="sAtk">-</div></div>
          <div><div class="label">방어</div><div id="sDef">-</div></div>
          <div><div class="label">행운</div><div id="sLuk">-</div></div>
          <div><div class="label">민첩</div><div id="sAgi">-</div></div>
        </div>

        <div class="label" style="margin-top:12px">팀원</div>
        <div id="teamList" class="list"></div>
      </div>

      <!-- 중앙: 턴 정보/순서 큐/이미지/액션 -->
      <div class="card">
        <div class="turnbox" style="width:100%">
          <div id="turnTeam" style="font-weight:700;">-</div>

          <!-- 순서 큐 -->
          <div id="queue" class="queue"></div>

          <!-- 현재 안내 대상 큰 이미지 -->
          <div class="imgbox"><img id="turnImg" alt=""></div>

          <!-- 타이머: 팀 5분 + 안내용 서브 타이머 -->
          <div id="turnTimer" class="label">-</div>
          <div id="subTimer" class="subhint">-</div>

          <div class="row">
            <button id="btnAttack" class="btn btn-gold" disabled>공격</button>
            <button id="btnDefend" class="btn" disabled>방어</button>
            <button id="btnDodge"  class="btn" disabled>회피</button>
            <button id="btnItem"   class="btn" disabled>아이템</button>
            <button id="btnPass"   class="btn" disabled>패스</button>
          </div>
        </div>
      </div>

      <!-- 우: 채팅/로그 분리 -->
      <div class="card">
        <div class="label">채팅</
