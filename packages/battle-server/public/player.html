<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PYXIS - 전투 참가자</title>

  <!-- Socket.IO -->
  <script src="/socket.io/socket.io.js"></script>

  <!-- 스타일: 네이비-골드 테마 -->
  <style>
    :root{
      --deep:#0b1117; --deep2:#131b24;
      --border:#2a3441; --gold:#dcc7a2; --gold2:#e6d2a8;
      --txt:#e5e7eb; --muted:#9aa4b2;
    }
    body{margin:0;background:linear-gradient(135deg,var(--deep),var(--deep2));color:var(--txt);
         font-family:ui-sans-serif,system-ui,"Apple SD Gothic Neo","Noto Sans KR",sans-serif}
    header{padding:10px 16px;border-bottom:1px solid rgba(255,255,255,.08);background:rgba(0,0,0,.25)}
    .brand{font-weight:700;color:var(--gold2)}
    .conn{float:right;font-size:12px;color:var(--muted)}
    .dot{display:inline-block;width:8px;height:8px;border-radius:50%;background:#666;margin-left:6px}
    .dot.ok{background:#10b981}

    /* 인증 오버레이 */
    #authOverlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;
                 background:rgba(0,0,0,.45);backdrop-filter:blur(2px);z-index:50}
    #authOverlay.hidden{display:none}
    #authOverlay .sheet{background:rgba(19,27,36,.9);border:1px solid var(--border);
                        border-radius:12px;padding:20px;min-width:260px;text-align:center}
    .spinner{width:48px;height:48px;border-radius:50%;border:6px solid rgba(220,199,162,.25);
             border-top-color:var(--gold2);margin:0 auto;animation:spin 1s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}
    .toast{position:fixed;left:50%;bottom:14px;transform:translateX(-50%);
           background:rgba(19,27,36,.9);border:1px solid var(--border);padding:8px 12px;
           border-radius:10px;font-size:14px;opacity:0;transition:.2s;z-index:60}
    .toast.show{opacity:1;transform:translateX(-50%) translateY(-4px)}
  </style>
</head>
<body>
  <header>
    <span class="brand">PYXIS 전투 참가자</span>
    <span class="conn">서버 연결 <i id="connDot" class="dot"></i></span>
  </header>

  <!-- 접속/인증 오버레이 -->
  <div id="authOverlay">
    <div class="sheet">
      <div class="spinner"></div>
      <div style="margin-top:10px;color:var(--gold2);font-weight:700">접속 중…</div>
      <div id="authHint" class="muted" style="margin-top:6px">서버와 인증을 확인하는 중</div>
    </div>
  </div>

  <!-- 메인 레이아웃 -->
  <main style="padding:12px">
    <!-- 내 카드 -->
    <section>
      <div id="meAvatar" style="width:72px;height:72px;background:#111;border-radius:12px"></div>
      <div id="meName">이름</div>
      <div id="meTeam" class="muted">A팀</div>
      <div id="meHp">100/100</div>
      <div style="height:6px;background:#333;border-radius:8px">
        <div id="meHpBar" style="height:6px;background:#22c55e;width:100%"></div>
      </div>
      <div>공 <span id="sAtk">1</span> 방 <span id="sDef">1</span>
          민 <span id="sAgi">1</span> 운 <span id="sLuk">1</span></div>
      <div id="myItems"></div>
      <button id="btnReady">준비 완료</button>
    </section>

    <!-- 현재 턴 -->
    <section style="margin-top:20px">
      <div>현재 차례: <b id="turnTeam">-</b></div>
      <div id="turnTimer">--:--</div>
      <div id="queue"></div>
      <img id="turnImg" style="width:80px;height:80px;border-radius:12px;margin-top:6px"/>
    </section>

    <!-- 액션 버튼 -->
    <section style="margin-top:20px">
      <button id="btnAttack" disabled>공격</button>
      <button id="btnDefend" disabled>방어</button>
      <button id="btnDodge"  disabled>회피</button>
      <button id="btnItem"   disabled>아이템</button>
      <button id="btnPass"   disabled>패스</button>
    </section>

    <!-- 로그 & 채팅 -->
    <section style="margin-top:20px">
      <div id="log" style="border:1px solid var(--border);padding:8px;height:180px;overflow:auto"></div>
      <div style="margin-top:10px">
        <input id="chatMsg" placeholder="메시지 입력 후 Enter" style="width:70%"/>
        <button id="btnSend">전송</button>
      </div>
    </section>
  </main>

  <div id="toast" class="toast"></div>

  <!-- 클라이언트 JS -->
  <script src="/assets/js/socket-manager.js"></script>
  <script src="/assets/js/player.js"></script>
</body>
</html>
