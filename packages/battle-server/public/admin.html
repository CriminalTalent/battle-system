<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>전투 시스템 · 관리자</title>

  <!-- 기존 사이트의 공용 CSS가 있다면 그대로 로드됩니다(디자인 변경 방지). -->
  <!-- 예: <link rel="stylesheet" href="/assets/css/app.css"> -->
</head>
<body>
  <!-- 헤더: 연결 상태 점/ 메타 -->
  <header class="header">
    <div id="connDot" class="conn-dot"></div>
    <div class="title">전투 시스템 · 관리자</div>
    <div id="battleMeta" class="meta">대기 중</div>
  </header>

  <main class="container">
    <!-- 좌영역: 전투 생성/제어, 참여자 추가, 링크/비밀번호 -->
    <section class="panel panel-left">
      <!-- 전투 설정 -->
      <section class="block">
        <h2>전투 설정</h2>
        <div class="row">
          <label for="mode">모드</label>
          <select id="mode">
            <option value="1v1">1v1</option>
            <option value="2v2">2v2</option>
            <option value="3v3">3v3</option>
            <option value="4v4" selected>4v4</option>
          </select>
          <button id="btnCreate" class="btn">전투 생성</button>
          <button id="btnStart"  class="btn btn-sec" disabled>전투 시작</button>
          <button id="btnPause"  class="btn btn-sec" disabled>일시 정지</button>
          <button id="btnResume" class="btn btn-sec" disabled>재개</button>
          <button id="btnEnd"    class="btn btn-sec" disabled>종료</button>
        </div>
      </section>

      <!-- 참여자 추가 -->
      <section class="block">
        <h2>전투 참여자 추가</h2>
        <div class="grid two">
          <div class="col">
            <div class="row"><label>이름</label><input id="pName" type="text" placeholder="이름" /></div>
            <div class="row">
              <label>팀</label>
              <select id="pTeam">
                <!-- 표기: A/B 로만 노출 (내부 값은 phoenix / eaters 유지) -->
                <option value="phoenix">A팀</option>
                <option value="eaters">B팀</option>
              </select>
            </div>
            <div class="row"><label>HP</label><input id="pHp"  type="number" min="1" max="100" value="100" /></div>
            <div class="row"><label>공격</label><input id="sAtk" type="number" min="1" max="5" value="3" /></div>
            <div class="row"><label>방어</label><input id="sDef" type="number" min="1" max="5" value="3" /></div>
            <div class="row"><label>민첩</label><input id="sAgi" type="number" min="1" max="5" value="3" /></div>
            <div class="row"><label>행운</label><input id="sLuk" type="number" min="1" max="5" value="2" /></div>
            <div class="row"><label>디터니</label><input id="iDit"  type="number" min="0" value="0" /></div>
            <div class="row"><label>공격 보정기</label><input id="iAtkB" type="number" min="0" value="0" /></div>
            <div class="row"><label>방어 보정기</label><input id="iDefB" type="number" min="0" value="0" /></div>
          </div>

          <div class="col">
            <div id="preview" class="preview">미리보기</div>
            <div class="row">
              <label>아바타</label>
              <input id="pAvatar" type="file" accept="image/png,image/jpeg,image/gif,image/webp" />
            </div>
            <div class="row end">
              <button id="btnAdd" class="btn" disabled>참여자 추가</button>
            </div>
          </div>
        </div>
      </section>

      <!-- 링크/비밀번호 -->
      <section class="block">
        <h2>링크/비밀번호 발급</h2>

        <div class="row">
          <button id="btnGenPlayer" class="btn" disabled>플레이어 링크 생성</button>
        </div>
        <div id="playerLinks" class="links"></div>

        <div class="row">
          <button id="btnGenSpectator" class="btn btn-sec" disabled>관전자 비밀번호 발급</button>
          <input id="spectatorOtp" type="text" readonly placeholder="관전자 비밀번호" />
        </div>
        <div class="row">
          <button id="btnBuildSpectator" class="btn btn-sec" disabled>관전자 URL 생성</button>
          <input id="spectatorUrl" type="text" readonly placeholder="관전자 접속 URL" />
        </div>
      </section>
    </section>

    <!-- 우영역: 현재 참여자 / 로그 / 채팅 -->
    <section class="panel panel-right">
      <!-- 현재 참여자 -->
      <section class="block">
        <h2>현재 참여자</h2>
        <div class="grid two">
          <div class="col">
            <!-- 표기: A팀 -->
            <div class="caption">A팀</div>
            <table class="table" id="listA">
              <thead>
                <tr>
                  <th>이름</th><th>HP</th><th>스탯</th><th>아이템</th><th>상태</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          <div class="col">
            <!-- 표기: B팀 -->
            <div class="caption">B팀</div>
            <table class="table" id="listB">
              <thead>
                <tr>
                  <th>이름</th><th>HP</th><th>스탯</th><th>아이템</th><th>상태</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- 전투 로그 -->
      <section class="block">
        <h2>전투 로그</h2>
        <div id="log" class="log"></div>
      </section>

      <!-- 채팅 -->
      <section class="block">
        <h2>채팅</h2>
        <div id="chat" class="chat"></div>
        <div class="row">
          <input id="chatMsg" type="text" placeholder="메시지 입력" />
          <button id="btnSend" class="btn btn-sec">보내기</button>
        </div>
      </section>
    </section>
  </main>

  <div id="toast" class="toast"></div>

  <!-- Socket.IO 클라이언트: 서버 SOCKET_PATH=/socket.io 를 강제 지정 -->
  <script src="/socket.io/socket.io.js"></script>

  <!-- 연결 신호가 확실히 /socket.io 로 가도록 1줄 강제 (디자인 영향 없음) -->
  <script>
    window.__SOCKET_PATH__ = '/socket.io';
  </script>

  <!-- 관리자 스크립트(이미 제공된 최신본). 경로/ID만 일치하면 작동합니다. -->
  <script defer src="/assets/js/admin.js"></script>
</body>
</html>
